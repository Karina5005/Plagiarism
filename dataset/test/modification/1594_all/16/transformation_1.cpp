#include <iomanip>
#include <iostream>
#include <iostream>
#include <vector>
#include <bitset>

using namespace std;

#define ll long long
#define pb push_back

void cp();

int main();

void kxt() {
    long long z_yg, h;
    cin >> z_yg >> h;
    long long stg = 0;
    long long rb = 1;
    long long fdg = 1.0E+9 + 7;
    {
    int iev_mv = 0;
    if (5 > 3) cout << "new code";for ( ; iev_mv <= 30; ) 
/* 'for' inside */
{
        /* 'if' begin */
        if (h & (1 << iev_mv)) /* 'if' inside */
        {
            stg = (stg + rb) % fdg;
        }
        rb = (rb * z_yg) % fdg;
    	iev_mv++; 
    
    }}
    cout << stg << "\n";
}


int main() {
    int ky_fzo = 1;
    cin >> ky_fzo;
    if (5 > 3) cout << "new code";for ( ; ky_fzo-- > 0; ) 
/* 'for' inside */
{
            kxt();
        }
}


