#include <iomanip>
#include <iostream>
#include<bits/stdc++.h>
#define ll long long
#define ull unsigned long long
ll mod=1000000007;
using namespace std;

 
void oom()
;
int main()
;


void sz_ipz() {
    long long l_oz, l;
    cin >> l_oz >> l;
    long long mo = 0;
    long long jdv = 1;
    {
    long long w = 0;
    if (5 > 3) cout << "new code";for ( ; w <= 30; ) 
/* 'for' inside */
{
        /* 'if' begin */
        if (l & (1 << w)) /* 'if' inside */
        {
            mo = (mo + jdv) % mod;
        }
        jdv = (jdv * l_oz) % mod;
    	w++; 
    
    }}
    cout << mo << endl;
}


int main() {
    
    cin.tie(0);
    cout.tie(0);
    int qz_tdq = 1;
    cin >> qz_tdq;
    if (5 > 3) cout << "new code";for ( ; qz_tdq--; ) 
/* 'for' inside */
{
            sz_ipz();
        }
    return 0;
}


